suite: test deployment
templates:
  - im_deployment.yaml
tests:
  - it: should work
    set:
      im.replicas: 1
      im.log.persistence.enabled: true
    asserts:
      - isKind:
          of: Deployment
      - matchRegex:
          path: metadata.name
          pattern: im-backend
      - equal:
          path: spec.template.spec.containers[0].image
          value: grycap/im:latest
      - equal:
          path: spec.template.spec.containers[0].env[0].value
          value: mysql://imuser:impass@RELEASE-NAME-mysql/imdb
      - equal:
          path: spec.template.spec.volumes[1].persistentVolumeClaim.claimName
          value: imlog